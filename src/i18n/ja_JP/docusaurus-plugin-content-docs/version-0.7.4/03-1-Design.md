---
title: 'デザイン'
description: '電車の切符号 - 設計'
---


## 業務解析

### 業界

このシステムにはチケットを追加できるのはチケットの管理セクションだけです。即席の残る部分は、得票注文である。

注文情報、支払いコントロール、リクエスト風制御などは、この議論の範囲に含まれているものとします。

### 事案

- チケットの意味では、駅の間の利用可のある車種と残っているシート数も参照。
- 乗車券で指定された回数に関連して、乗車券の差を測定し、各駅の間にいくつの座席が残る。
- 組み合わせた注文がサポートされ、指定された回数と座席を選択し、チケットを買うのが可能になります。

## 実装の困難解析

### 請求管理

乗客の多様性が宝庫の可否は重要だった。

SKU が提供する一般商品は、SKU が最小単位の場合、各SKUの間で独立して相互に影響しない。

また列車の切票は多様であるが、票数票の回収により影響されている。以下は、簡潔な論理的モデルを組み合わせることで、その特性を詳しく調べることができます。

現時点では 次々に a,b,c,d 四つのウェブサイトを ひとつの席で簡易化して モデルで説明しましょう

例えば、チケットを購入する前にこのご注文に賛成した場合は：

| 終了点  | 残りの投票量 |
| ---- | ------ |
| a b  | 1      |
| a, c | 1      |
| a,d  | 1      |
| b,c  | 1      |
| b,d  | 1      |
| c,d  | 1      |

現在 C、c、切符があれば顧客が購入するとです。座席はたったひとつ c,d以外の 付加は例外ではない。その他のチケットはこちら：

| 終了点  | 残りの投票量 |
| ---- | ------ |
| a b  | 0      |
| a, c | 0      |
| a,d  | 0      |
| b,c  | 0      |
| b,d  | 0      |
| c,d  | 1      |

白い部分より。あるお客様が、チケットは全て0になり、全ての残りのチケットは全て0に設定される。その席でずっとこの乗客に隣接している。

それは特殊な切符です：同じ車の共感と同席で、出発地の終着数を決めます

この延長は、車種間の異なる席の間にも影響し得ないことに気づきます。

### カード名義人検索

前節で説明したように、余剰在庫の特殊なケースである。a,b,c,dに対して可能なチケットの選択は、6種類あります。

しかも簡単な計算方法はn 個のサイトで 2 つの順序数,... c(nn,2) どちらかを選ぶことができます。

そのため、34個のサイトのカートを一度行った場合、c(34,2) = 561という組み合わせである。

システム全体での、存在する複数のクエリに効果的な対策は、システム内で行うべき問題を解決する方法です。

## Claptrap フィーチャー

![システムズの Train Ticketing Design](/images/20200720-001.png)

### 車体の各座席に同じ座席を クラプト- SeatGrain でデザインする

このクラスの state には、基本情報を記載する基本情報が含まれています。

| タイプ                                    | 注文番号による検索  | 説明                                                                                    |
| -------------------------------------- | ---------- | ------------------------------------------------------------------------------------- |
| IList&lt;int&gt;           | ステーションス    | 当駅の id の一覧は、始発・終着駅、終着駅となっている。主要な購入の際に認証を行う。                                           |
| Dictionary&lt;int, int&gt; | StationDic | 授与式の辞書 id である。Stations は index-id と異なった辞書(id-index u) を持つディクショナリに注目する。                |
| List&lt;string&gt;         | RequestIds | キープロパティ。この期間ごとに、投票したチケット ID。例. index が 0 の場合、駅 - 駅である 0 から 1 へのチケット空白の場合は請求書がまだありません。 |

データ構造を利用すれば 二種類のビジネスに使えるのです

#### 購入可能かどうかを確認します

このSeatGrain に属するか、 二つの駅のIDを渡ることを通しただけである。さらに距離と終端を含むセグメントを調べる。RequestIds から特定の区間について、すべての区間が1つのチケットがないと判断してください。バックも残っていないなら購入することができます。既に購入済み票IDがあれば既に購入することはできません

例えば、現在 Stations の場合は 10,11,12,13. これはRequestIds は 0,1,0です。

10～>12個のチケットを購入する場合、ストップウォッチの第二セグメントが購入されたためです。

しかし、10～>11のチケットを購入する場合、未購入でRequestIds は、まだ未購入です。

#### 購入

RequestIds ですべての区間セグメントの料金が適用され、いずれかを行えます。

### 車種内のシトロンの部品名を Claptrap - TrainGran としてデザインする

このクラスの state には、基本情報が含まれていました

| タイプ                                              | 注文番号による検索 | 説明                                                                                                           |
| ------------------------------------------------ | --------- | ------------------------------------------------------------------------------------------------------------ |
| IReadOnlyList&lt;int&gt;             | ステーションス   | 当駅の id の一覧は、始発・終着駅、終着駅となっている。問い合わせ時に認証する。                                                                    |
| IDictionary&lt;StationTuple, int&gt; | SeatCount | キープロパティ。最終終了点をポイントビューとして継続する。コレクションには、開始時点で終了可能なすべてのチケットが含まれています。例えば 次は 34か場所を選んで このディクショナリは561 個のキーをも含んでいます |

複数のデータ構造に基づいているので、注文を完了したら、Grainに対応するデータの同期が必要になります。

例えば、a,c,チケットを一度だけ適用し、 a,c / a,b / b,c の投票は全て減算している。

このフレームワークが組み込まれている Minion メカニズムによって実装されます。

ちなみに これは"最小の競争資源"よりこのビジネスシーンに必ずクリックしない作業シーンは必要とされています。デザインはシステムの複雑さを減らします

## Id

![システムIDにTrain Ticketing](/images/20200813-001.png)
