---
title: '状態スナップショット (ステート スナップショット)'
metaTitle: '状態スナップショット (ステート スナップショット)'
metaDescription: '状態スナップショット (ステート スナップショット)'
---

> [現在表示されているバージョンは、機械が簡体字中国語から翻訳され、手動校正の結果です。ドキュメントに不適切な翻訳がある場合は、こちらをクリックして翻訳提案を提出してください。](https://crwd.in/newbeclaptrap)

## ステート Snapshot は、状態の復元速度を高速化します。

アクティブ状態の Claptrap は、現在の最新のデータ状態である State です。これは、イベント トレースによって永続化レイヤーから復元されます。イベントの数が膨大になる場合があります。イベントを使用して State を復元するのに時間がかかります。したがって、特定の条件の後に特定の Claptrap の状態を永続化するために、Claptrap フレームワークでステータス スナップショットが提供されます。この条件は、通常、次の項目です。：

1. いくつかのイベントが実行された後。
2. Claptrap Deactive の場合。
3. 一定の期間にわたって。

イベント スナップショットの存在により、状態が永続レイヤーから復元される速度が向上します。永続層にスナップショットが存在する場合、通常、1 つの状態の復元は、次の手順に従って行われます。：

1. 状態スナップショットを読み取ります。
2. 状態スナップショットの対応するバージョン番号から開始し、状態の更新のためにすべてのイベントを逆方向に読み取ります。
3. 永続層に残りのイベントがなくなるまで状態を更新します。

ただし、スナップショットがない場合、復元手順は次のようになります。：

1. 初期状態を作成するには、ユーザーカスタム メソッドを使用します。
2. 状態の更新のためにすべてのイベントをイベント ライブラリから読み取ります。
3. 永続層に残りのイベントがなくなるまで状態を更新します。

しかし。スナップショットの存在は、いくつかの特殊性をもたらします。上記の作業手順と組み合わせると、スナップショットが形成されると、簡単に見つけることができます。：

1. ユーザーのカスタム メソッドは実行されません。
2. スナップショットのバージョン番号より小さいイベントは再実行されません。

現在、フレームワークは Id ごとに最後のスナップショットを 1 つだけ保持できます。
